using System;
using System.Data.SqlClient;

class Program
{
    static string connectionString = "User ID=sa;password=examlyMssql@123; server=localhost; Database=appdb;trusted_connection=false; Persist Security Info=False; Encrypt=False;";

    static void Main()
    {
        using SqlConnection connection = new SqlConnection(connectionString);
        try
        {
            connection.Open();
            Console.WriteLine("Connection successful!");

            Console.WriteLine("Select an option:");
            Console.WriteLine("1. Add Student");
            Console.WriteLine("2. Display All Students");

            string? option = Console.ReadLine();

            if (option == "1")
            {
                Console.WriteLine("Enter student details:");
                Console.Write("Student ID: ");
                int id = int.Parse(Console.ReadLine()!);

                Console.Write("Student Name: ");
                string name = Console.ReadLine()!;

                Console.Write("Student Age: ");
                int age = int.Parse(Console.ReadLine()!);

                Console.Write("Student Gender: ");
                string gender = Console.ReadLine()!;

                Console.Write("Student Mobile Number: ");
                string mobile = Console.ReadLine()!;

                Console.Write("Student Email: ");
                string email = Console.ReadLine()!;

                AddStudent(connection, id, name, age, gender, mobile, email);
            }
            else if (option == "2")
            {
                DisplayAllStudents(connection);
            }
            else
            {
                Console.WriteLine("Invalid option selected.");
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine("Connection failed! " + ex.Message);
        }
    }

    public static void AddStudent(SqlConnection connection, int studentid, string studentName, int studentAge, string studentGender, string studentMobileNumber, string studentEmail)
    {
        string query = "INSERT INTO Student (Studentid, StudentName, StudentAge, StudentGender, StudentMobileNumber, StudentEmail) VALUES (@id, @name, @age, @gender, @mobile, @email)";
        using SqlCommand cmd = new SqlCommand(query, connection);
        cmd.Parameters.AddWithValue("@id", studentid);
        cmd.Parameters.AddWithValue("@name", studentName);
        cmd.Parameters.AddWithValue("@age", studentAge);
        cmd.Parameters.AddWithValue("@gender", studentGender);
        cmd.Parameters.AddWithValue("@mobile", studentMobileNumber);
        cmd.Parameters.AddWithValue("@email", studentEmail);

        int result = cmd.ExecuteNonQuery();
        if (result > 0)
        {
            Console.WriteLine("Student added successfully!");
        }
        else
        {
            Console.WriteLine("Failed to add student.");
        }
    }

    public static void DisplayAllStudents(SqlConnection connection)
    {
        string query = "SELECT * FROM Student";
        using SqlCommand cmd = new SqlCommand(query, connection);
        using SqlDataReader reader = cmd.ExecuteReader();

        Console.WriteLine("\nStudent Records:");
        while (reader.Read())
        {
            Console.WriteLine($"ID: {reader["Studentid"]}");
            Console.WriteLine($"Name: {reader["StudentName"]}");
            Console.WriteLine($"Age: {reader["StudentAge"]}");
            Console.WriteLine($"Gender: {reader["StudentGender"]}");
            Console.WriteLine($"Mobile Number: {reader["StudentMobileNumber"]}");
            Console.WriteLine($"Email: {reader["StudentEmail"]}");
            Console.WriteLine("------------------------");
        }
    }
}
